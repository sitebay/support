(()=>{(()=>{var g=new Date;function s(e=0){let o=new Date;return o.setTime(o.getTime()+e*24*60*60*1e3),o}function m(e){if(localStorage.getItem(e)===null)return;let o=new Date,r=localStorage.getItem(`${e}_exp`),t=r!==null?new Date(r):o;if(isNaN(t)){localStorage.removeItem(`${e}_exp`);return}o<t||(localStorage.removeItem(e),localStorage.removeItem(`${e}_exp`))}function u(e,o,r=null,t=!0){let a=localStorage.getItem(e);a!==null&&a!==o&&!t||(localStorage.setItem(e,o),r!==null&&localStorage.setItem(`${e}_exp`,r.toUTCString()))}function f(e,o,r=null,t=!0){if(o=encodeURIComponent(o),document.cookie.indexOf(`${e}=`)>=0&&document.cookie.indexOf(`${e}=${o}`)<0&&!t)return;let a=r!==null?`expires=${r.toUTCString()}; `:"";document.cookie=`${e}=${o}; domain=.sitebay.org; ${a}path=/; secure; samesite=lax; `}function l(e){let o=new URL(window.location.href),r=o.searchParams.get(e.param);if(e.local&&m(e.local),!r||e.regex&&!r.match(e.regex))return;let t=e.days?s(e.days):null;e.local&&u(e.local,r,t),e.cookie&&f(e.cookie,r,t)}l({param:"r",cookie:"referralCode",days:14,regex:/^[0-9a-f]{40}$/i});var d=Object.fromEntries(document.cookie.split(/\s*;\s*/).map(e=>e.split(/\s*=\s*/))),p=document.getElementsByTagName("body")[0];d.referralCode&&p.classList.add("js-is-referral"),l({param:"promo",cookie:"promoCode",local:"promoCode",days:1,regex:/^[0-9a-z-_]*$/i}),l({param:"promo_length",cookie:"promoLength",local:"promoLength",days:1,regex:/^[0-9]*$/}),l({param:"promo_value",cookie:"promoValue",local:"promoValue",days:1,regex:/^[0-9]*$/});function n(e,o){if(typeof e!="string"||e.match(/[^a-zA-Z0-9_\-]/))return;let r=Array.from(document.querySelectorAll('a[href*="login.sitebay.org"]'));r=r.filter(t=>{let a=new URL(t.href);return!(!a.pathname.match(/\/signup/)||a.searchParams.has("promo")&&(!o||!t.hasAttribute("data-promo-override")))}),r.forEach(t=>{let a=new URL(t.href);e?a.searchParams.set("promo",e):a.searchParams.delete("promo"),t.href=a.toString()})}var i=Object.fromEntries(document.cookie.split(/\s*;\s*/).map(e=>e.split(/\s*=\s*/))),c=localStorage.getItem("promoCode");i.referralCode?n("",!0):(c||i.promoCode)&&n(c||i.promoCode,!0)})();})();
