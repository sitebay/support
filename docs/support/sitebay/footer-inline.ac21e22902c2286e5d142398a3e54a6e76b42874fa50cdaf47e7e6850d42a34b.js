(()=>{(()=>{function s(e=0){let o=new Date;return o.setTime(o.getTime()+e*24*60*60*1e3),o}function m(e){if(localStorage.getItem(e)===null)return;let o=new Date,r=localStorage.getItem(`${e}_exp`),t=r!==null?new Date(r):o;if(isNaN(t)){localStorage.removeItem(`${e}_exp`);return}o<t||(localStorage.removeItem(e),localStorage.removeItem(`${e}_exp`))}function f(e,o,r=null,t=!0){let l=localStorage.getItem(e);l!==null&&l!==o&&!t||(localStorage.setItem(e,o),r!==null&&localStorage.setItem(`${e}_exp`,r.toUTCString()))}function u(e,o,r=null,t=!0){if(o=encodeURIComponent(o),document.cookie.indexOf(`${e}=`)>=0&&document.cookie.indexOf(`${e}=${o}`)<0&&!t)return;let l=r!==null?`expires=${r.toUTCString()}; `:"";document.cookie=`${e}=${o}; domain=.sitebay.org; ${l}path=/; secure; samesite=lax; `}function a(e){let o=new URL(window.location.href),r=o.searchParams.get(e.param);if(e.local&&m(e.local),!r||e.regex&&!r.match(e.regex))return;let t=e.days?s(e.days):null;e.local&&f(e.local,r,t),e.cookie&&u(e.cookie,r,t)}a({param:"r",cookie:"referralCode",days:14,regex:/^[0-9a-f]{40}$/i});var p=Object.fromEntries(document.cookie.split(/\s*;\s*/).map(e=>e.split(/\s*=\s*/))),d=document.getElementsByTagName("body")[0];p.referralCode&&d.classList.add("js-is-referral"),a({param:"promo",cookie:"promoCode",local:"promoCode",days:1,regex:/^[0-9a-z-_]*$/i}),a({param:"promo_length",cookie:"promoLength",local:"promoLength",days:1,regex:/^[0-9]*$/}),a({param:"promo_value",cookie:"promoValue",local:"promoValue",days:1,regex:/^[0-9]*$/});function i(e,o){if(typeof e!="string"||e.match(/[^a-zA-Z0-9_\-]/))return;let r=Array.from(document.querySelectorAll('a[href*="login.sitebay.org"]'));r=r.filter(t=>{let l=new URL(t.href);return!(!l.pathname.match(/\/signup/)||l.searchParams.has("promo")&&(!o||!t.hasAttribute("data-promo-override")))}),r.forEach(t=>{let l=new URL(t.href);e?l.searchParams.set("promo",e):l.searchParams.delete("promo"),t.href=l.toString()})}var n=Object.fromEntries(document.cookie.split(/\s*;\s*/).map(e=>e.split(/\s*=\s*/))),c=localStorage.getItem("promoCode");n.referralCode?i("",!0):c||n.promoCode?i(c||n.promoCode,!0):fetch("https://www.sitebay.org/wp-json/sitebay/v1/promo-data").then(e=>{if(!e.ok)throw new Error("");return e}).then(e=>e.json()).then(e=>{e.global&&e.global.promo_code&&i(e.global.promo_code,!1)}).catch(e=>{})})();})();
